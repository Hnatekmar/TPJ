\documentclass[a4paper,11pt]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage{upgreek}
\usepackage{amsmath}
\usepackage{mathabx}
\usepackage{MnSymbol}
\usepackage{wasysym}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage[]{algorithm2e}
\usepackage{hyperref}
\usepackage{tikz}
\usepackage{rotating}
\usepackage{placeins}
\usetikzlibrary{arrows,automata,positioning}

\author{Martin Hnátek}
\title{Programovací jazyk Mirage}

\date{}

\begin{document}

\maketitle

\newpage
\tableofcontents

\newpage
\section{Gramatiky}
V této sekci se nachází popis jednotlivých gramatik, které jsou zpracovány lexikálním analyzátorem.

\subsection{Identifikátory}
Identifikátor začíná na kterýkoliv znak z množiny $z = \{a..z, A..Z, +, -, /, *, <\}$
a pokračuje v libovonlném znaku z množiny $m = z \bigcup \{0..9\}$ 
\linebreak

$G_{identifikatory}$(\{S, A, B\}, \{z, m\}, P, S)
$$S \rightarrow zA | z$$
$$A \rightarrow mA | m$$

\subsection{Čísla}
$G_{cisla}$(\{S, B, C\}, \{d, .\}, P, S)
$$S \rightarrow dB | d$$
$$B \rightarrow dB | d | .C$$
$$C \rightarrow dC | d$$

\subsection{Řetězce}
Řetězce začínají a končí na znak ". V samotném řetězci se pak může nacházet jakýkýkoliv znak před kterým se nachází $\backslash$ nebo cokoliv v množině $\blacksquare$, která reprezentuje všechny tisknutelné znaky, které nejsou $\backslash$ nebo ".

$G_{retezce}$(\{S, D, E\}, \{$\backslash, ", \blacksquare$\}, P, S)
$$S \rightarrow "D$$
$$D \rightarrow " | \backslash E | \blacksquare E$$
$$E \rightarrow "D | \backslash D | \blacksquare D$$

\subsection{Závorky}
Závorky hrají v lispu důležitou roli. Rozhodl jsem se, že pro jednoduchost bude jazyk podporovat jen \textquotedblleft kulaté \textquotedblright závorky
$G_{zavorky}$(\{S\}, \{(, )\}, P, S)

$$S \rightarrow (|)$$

\subsection{Gramatika bílých znaků}
Je gramatika popisující všechny bílé znaky $G_{bileznaky}$(\{S\}, \{$\dlsh | \mapsto | \sqcup$\}, P, S)
$$S \rightarrow  \dlsh S | \mapsto S | \sqcup S$$

\subsection{Komentáře}
Jazyk má jednoduché komentáře začínající na ; nebo \# a končící novým řádkem $G_{komentare}$(\{S, F\}, \{$\dlsh$, ;, $\Square$\}, P, S)

$$S \rightarrow ;F $$
$$F \rightarrow \Square F | \dlsh S$$

\subsection{Symboly pro expanzi parserem}

$G_{expanze}$(\{S, G\}, \{ $\boxplus$, \# \})

$$S \rightarrow \#G$$
$$G \rightarrow \boxplus G | \boxplus$$

Kde $\boxplus$ je množina všech nebilých znaků včetně \#. 

\subsection{Logické hodnoty}
Logická hodnota může být buď \$p pro pravdu (true) a \$n pro nepravdu:
\\
$G_{logicke}$(\{S, H\}, \{\$, n, p\})

$$S \rightarrow \$H$$
$$H \rightarrow n | p$$

\section{Stavový automat}
Nyní je třeba z předem definované gramatiky spojit a převést na automat. Pokud tento automat nebude deterministický je třeba jej determinizovat.

Samotný jazyk se skládá z jazyku oddělovačů (komentáře, bílé znaky) $L_{od} = G_{komentare} \bigcup G_{bileznaky}$ a jazyku významových tokenů. 

$$L_{vt} = L_{identifikatory} \bigcup L_{cisla} \bigcup L_{retezce} \bigcup L_{zavorky}$$
Celý jazyk pak lze zapsat tímto způsobem 
$$L = (L^{*}_{od}.L_{vt})^{*}.L^{*}_{od}$$
Po spojení nám vzniká gramatika
 
%%% Gramatika
$G_{vt}$(\{S, $S_{identifikatory}$, $S_{cisla}$, $S_{retezce}$, $S_{zavorky}$, A, B, C, D, E, F, G\}, \{d, z, m, (, ), $\backslash$ \}, P, S), která reprezentuje významové tokeny 

$$S \rightarrow S_{identifikatory} | S_{cisla} | S_{retezce} | S_{zavorky} | S_{od}$$

kde neterminál $S_{od}$ je definovaný v gramatice oddělovačů $G_{od}$(\{S, A\}, \{$\mapsto$, $\sqcup$, $\dlsh$, ;\}, P, S)

$$S \rightarrow \dlsh | \mapsto | \sqcup | ;A | \Square$$
$$A \rightarrow \Square A | ;A | \dlsh $$

Po spojení gramatik a odstranění jednoduchých pravidel dostaváme gramatiku
$G_{finalni}$(\{$S, A, B, C, D, E, F, G, H$\}, \{$\mapsto$, $\sqcup$, $\dlsh$, ;, $\Square$, $\backslash$, $\blacksquare$, $\boxplus$, ", d, ., z, m, (, ), \$, \#, p, n\}, P, S)
$$S \rightarrow zA | z | dB | d | "D | ;F | \dlsh S | \mapsto S | \sqcup S | ( | ) | \#G | \$H$$
$$A \rightarrow mA | m$$
$$B \rightarrow dB | d | .C$$
$$C \rightarrow dC | d$$
$$D \rightarrow " | \backslash E | \blacksquare D$$
$$E \rightarrow "D | \backslash D | \blacksquare D$$
$$F \rightarrow \Square F | \dlsh S$$
$$G \rightarrow \boxplus G | \boxplus$$
$$H \rightarrow n | p$$

% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
\begin{sidewaystable}[]
%\centering
	\begin{tabular}{@{}lcccccccccccccccccc@{}}
		\toprule
		\multicolumn{1}{c}{$\delta$} & z & m & d & . & $\backslash$ & “ & ( & ) & $\dlsh$ & $\mapsto$ & $\sqcup$ & ; & $\Square$ & $\boxplus$ & \$ & \# & p & n \\ \midrule
		$Q_{S}$ & $Q_{A\hat{F}}$ & - & $Q_{B, \hat{F}}$ & - & - & $Q_{D}$ & $Q_{\hat{F}}$ & $Q_{\hat{F}}$ & $Q_{S}$ & $Q_{S}$ & $Q_{S}$ & $Q_{F}$ & - & - & $Q_{H}$ & $Q_{G}$ & - & - \\
		$Q_{C}$ & $Q_{C, \hat{F}}$ & - & - & - & - & - & - & - & - & - & - & - & - & - & - & - & - & - \\
		$Q_{D}$ & - & - & - & - & - & $Q_{D}$ & - & $Q_{E}$ & - & - & $Q_{\hat{F}}$ & - & - & - & - & - & - & - \\
		$Q_{E}$ & - & - & - & - & - & $Q_{D}$ & - & $Q_{D}$ & - & - & $Q_{D}$ & - & - & - & - & - & - & - \\
		$Q_{F}$ & - & - & - & - &  & - & $Q_{F}$ & - & - & - & - & $Q_{S}$ & - & - & - & - & - & - \\
		$Q_{G}$ & - & - & - & - & - & - & - & - & - & - & - & - & - & $Q_{G, \hat{F}}$ &  &  & - & - \\
		$Q_{H}$ & - & - & - & - & - & - & - & - & - & - & - & - & - & - & - & - & $Q_{\hat{F}}$ & $Q_{\hat{F}}$ \\
		$Q_{\hat{F}}$ & - & - & - & - & - & - & - & - & - & - & - & - & - & - & - & - & - & - \\
		$Q_{A,\hat{F}}$ & - & - & $Q_{A\hat{F}}$ & - & - & - & - & - & - & - & - & - & - & - & - & - & - & - \\
		$Q_{B, \hat{F}}$ & $Q_{B, \hat{F}}$ & - & - & - & - & - & - & - & - & $Q_{C}$ & - & - & - & - & - & - & - & - \\
		$Q_{C, \hat{F}}$ & $Q_{C, \hat{F}}$ & - & - & - & - & - & - & - & - & - & - & - & - & - & - & - & - & - \\
		$Q_{G, \hat{F}}$ & - & - & - & - & - & - & - & - & - & - & - & - & - & $Q_{G, \hat{F}}$ & - & - & - & - \\ \bottomrule
		\end{tabular}
		\caption{Tabulka popisující DFA}
	\label{Tabulka popisující DFA}
\end{sidewaystable}

%\newpage

\input{automat.tex}

\section{Parsování}
Návrh gramatiky pro parser vychází z následujících syntaktických diagramů.
\newpage
\subsection{Program}
Každý program se skládá z 0 až $\infty$ výrazů.

\begin{figure}[!h]
	%\FloatBarrier
    \centering
    \includegraphics[width=0.3\textwidth]{obrazky/Program.png}
    \caption{Syntaktický diagram pro program}
    \label{fig:Syntaktický diagram pro program}
\end{figure}

\subsection{Atom}
Atom představuje základní element jazyka Mirage. Může to být buď řetězec, číslo nebo identifikátor.
\begin{figure}[!h]
	%\FloatBarrier
    \centering
    \includegraphics[width=0.5\textwidth]{obrazky/Atom.png}
    \caption{Syntaktický diagram pro Atom}
    \label{fig:Syntaktický diagram pro Atom}
\end{figure}

\newpage
\subsection{Vyraz}
\begin{figure}[!h]
	%\FloatBarrier
    \centering
    \includegraphics[width=0.5\textwidth]{obrazky/Vyraz.png}
    \caption{Syntaktický diagram pro Atom}
    \label{fig:Syntaktický diagram pro Atom}
\end{figure}
\subsection{Argument}
\begin{figure}[!h]
	%\FloatBarrier
    \centering
    \includegraphics[width=0.5\textwidth]{obrazky/Argument.png}
    \caption{Syntaktický diagram pro Atom}
    \label{fig:Syntaktický diagram pro Atom}
\end{figure}

\subsection{Expanze}
\begin{figure}[!h]
	%\FloatBarrier
    \centering
    \includegraphics[width=0.5\textwidth]{obrazky/Expanze.png}
    \caption{Syntaktický diagram pro Atom}
    \label{fig:Syntaktický diagram pro Atom}
\end{figure}

\section{Gramatika pro parsování}
$$Program \rightarrow Vyraz\:Program\:|\:\epsilon$$
$$Vyraz \rightarrow\:(\:Vyraz2\:|\:Expanze$$
$$Vyraz2 \rightarrow\:Argument\:Vyraz2\:|\:)$$
$$Argument \rightarrow Atom\:|\:Vyraz$$
$$Expanze \rightarrow nazev\:Argument$$
$$Atom \rightarrow cislo | identifikator | retezec$$

\subsection{Množina FF a parsovací tabulka}
Pro tvorbu parsovací tabulky je třeba spočítat množinu FF, která vychází z popsané gramatiky.

$$FF(S) = \{(,\} \bigcup FF(Expanze) = \{\}$$


\end{document}
